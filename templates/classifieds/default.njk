{% extends "system/layouts/base-with-system.njk" %}

{% block head %}
{{ super() }}
<link rel="stylesheet" href="/styles/classifieds-detail.css">
{% endblock %}

{% block content %}
<div class="ad-detail-container">
  <div class="ad-detail-grid">
    {# Left: Images #}
    <div class="ad-images">
      <div class="ad-main-image">
        {% if ad.image %}
          <img src="{{ ad.image }}" alt="{{ ad.title }}">
        {% else %}
          <div class="ad-image-placeholder">No Image Provided</div>
        {% endif %}
      </div>
      
      {# Gallery (if multiple images implemented) #}
      {% if ad.images and ad.images.length > 0 %}
        <div class="ad-image-gallery">
          {% for img in ad.images %}
            <div class="ad-gallery-thumb">
              <img src="{{ img.url or img }}" alt="Gallery image">
            </div>
          {% endfor %}
        </div>
      {% endif %}
    </div>

    {# Right: Info #}
    <div class="ad-info">
      <div class="ad-header">
        <nav class="ad-breadcrumb">
          <a href="/classifieds">Classifieds</a>
          <span>/</span>
          <span>{{ ad.category_name }}</span>
        </nav>
        <h1 class="ad-title">{{ ad.title }}</h1>
        
        {# Personal ad fields (no price!) #}
        <div class="ad-personal-info">
          {% if ad.age %}
          <span class="ad-age">{{ ad.age }} years old</span>
          {% endif %}
          {% if ad.relationship_status %}
          <span class="ad-relationship">{{ ad.relationship_status | replace('_', ' ') | title }}</span>
          {% endif %}
        </div>
      </div>

      <div class="ad-meta-grid">
        <div class="ad-meta-item">
          <label>Location</label>
          <p>{{ ad.location or 'Not specified' }}</p>
        </div>
        <div class="ad-meta-item">
          <label>Posted By</label>
          <p>{{ ad.owner_first_name }} {{ ad.owner_last_name }}</p>
        </div>
      </div>

      <div class="ad-description">
        <label>Description</label>
        {{ ad.description | nl2br | safe }}
      </div>

      {# Dynamic Regions #}
      {% for region_name, val in content %}
        {% if region_name != 'description' and val %}
          <div class="ad-region">
            <label>{{ region_name | replace('_', ' ') }}</label>
            <div class="ad-region-content">
              {{ val | safe }}
            </div>
          </div>
        {% endif %}
      {% endfor %}

      <div class="ad-actions">
        {# Use system message form component #}
        {% include "system/forms/classifieds-message-form.njk" %}

        {% if ad.contact_info %}
        <div class="contact-info">
          Direct Contact: {{ ad.contact_info }}
        </div>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
