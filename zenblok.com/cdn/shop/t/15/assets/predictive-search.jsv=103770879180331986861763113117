class PredictiveSearch{constructor(){this.container=document.getElementById("Search-Drawer"),this.form=this.container.querySelector("form.searchform"),this.button=document.querySelectorAll(".thb-quick-search"),this.input=this.container.querySelector('input[type="search"]'),this.defaultTab=this.container.querySelector(".side-panel-content--initial"),this.predictiveSearchResults=this.container.querySelector(".side-panel-content--has-tabs"),this.setupEventListeners()}setupEventListeners(){this.form.addEventListener("submit",this.onFormSubmit.bind(this)),this.input.addEventListener("input",debounce(event=>{this.onChange(event)},300).bind(this)),this.button.forEach((item,i)=>{item.addEventListener("click",event=>{var _this=this;return event.preventDefault(),document.getElementsByTagName("body")[0].classList.toggle("open-cc"),this.container.classList.toggle("active"),this.container.classList.contains("active")&&(setTimeout(function(){_this.input.focus({preventScroll:!0})},100),dispatchCustomEvent("search:open")),!1})})}getQuery(){return this.input.value.trim()}onChange(){const searchTerm=this.getQuery();if(!searchTerm.length){this.predictiveSearchResults.classList.remove("active");return}this.predictiveSearchResults.classList.add("active"),this.getSearchResults(searchTerm)}onFormSubmit(event){this.getQuery().length||event.preventDefault()}onFocus(){const searchTerm=this.getQuery();searchTerm.length&&this.getSearchResults(searchTerm)}getSearchResults(searchTerm){const queryKey=searchTerm.replace(" ","-").toLowerCase();this.predictiveSearchResults.classList.add("loading"),fetch(`${theme.routes.predictive_search_url}?q=${encodeURIComponent(searchTerm)}&${encodeURIComponent("resources[type]")}=product,article,query&${encodeURIComponent("resources[limit]")}=10&section_id=predictive-search`).then(response=>{if(this.predictiveSearchResults.classList.remove("loading"),!response.ok){var error=new Error(response.status);throw error}return response.text()}).then(text=>{const resultsMarkup=new DOMParser().parseFromString(text,"text/html").querySelector("#shopify-section-predictive-search").innerHTML;this.renderSearchResults(resultsMarkup)}).catch(error=>{throw error})}renderSearchResults(resultsMarkup){this.predictiveSearchResults.innerHTML=resultsMarkup;let _this=this;this.container.querySelector("#search-results-submit").addEventListener("click",()=>{_this.form.submit()})}close(){this.container.classList.remove("active")}}window.addEventListener("load",()=>{typeof PredictiveSearch<"u"&&new PredictiveSearch});
//# sourceMappingURL=/cdn/shop/t/15/assets/predictive-search.js.map?v=103770879180331986861763113117
